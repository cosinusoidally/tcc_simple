B8 01000000
50
E8 %get_param
83C4 04
50
E8 %THUNK_exit
83C4 04
E9 25000000
E8 %trap_syscalls_off
8B45 F8
50
B8 8F304000
50
E8 %THUNK_printf
83C4 08
B8 01000000
50
E8 %THUNK_exit
83C4 04
8B45 F4
C9
C3
:init_runtime
55
89E5
81EC 08000000
E8 %host_call_fn
B9 A2184000
51
50
E8 %wi32
83C4 08
E8 %host_stdout_addr
8945 FC
E8 %get_stdout
50
8B45FC
50
E8 %wi32
83C4 08
B8 2E174000
50
B8 08000000
50
E8 %set_reg
83C4 08
B8 B5304000
50
E8 %load_boot
83C4 04
50
B8 A6304000
50
E8 %THUNK_printf
83C4 08
E8 %command_file
B9 CC304000
51
8B4D 08
51
8945 F8
E8 %THUNK_fopen
83C4 08
50
8B45 F8
50
E8 %wi32
83C4 08
E8 %command_file
50
E8 %ri32
83C4 04
83F8 00
0F84 05000000
E9 1C000000
B8 CF304000
50
E8 %THUNK_printf
83C4 04
B8 01000000
50
E8 %THUNK_exit
83C4 04
C9
C3
:run_process
55
89E5
81EC 00000000
BC 00580408
FF25 18800408
C9
C3
:v_main
55
89E5
81EC 0C000000
B8 00000000
8945 FC
E8 %base_address
8B0D F4304000
8B15 f8304000
09d1
8B15 FC304000
09D1
8B15 00314000
8945 F4
8B05 04314000
09C2
8B05 08314000
09C2
B8 00000000
50
B8 00000000
50
52
51
B8 00000020
50
8B45 F4
50
E8 %mmap
83C4 18
8945 FC
E8 %base_address
8B4D FC
39C1
0F84 1C000000
B8 0C314000
50
E8 %THUNK_puts
83C4 04
B8 01000000
50
E8 %THUNK_exit
83C4 04
8B45 08
83F8 01
0F8E 29000000
8B45 0C
83C0 04
50
E8 %ri32
83C4 04
8945 F8
8B45 F8
50
B8 18314000
50
E8 %THUNK_printf
83C4 08
E9 16000000
B8 31314000
50
E8 %THUNK_printf
83C4 04
B8 5D314000
8945 F8
8B45 F8
50
E8 %init_runtime
83C4 04
E8 %run_process
B8 00000000
C9
C3
:TopLevelHandler
55
89E5
81EC 14000000
90
8B45 08
83C0 04
8B08
81C1 B8000000
8B01
8945 FC
8B45 08
83C0 04
8B 08
81C1 C4000000
8B01
8945 F8
8B45 FC
50
E8 %ri8
83C4 04
81F8 CD000000
0F85 F9010000
8B45 FC
40
50
E8 %ri8
83C4 04
81F8 80000000
0F85 E0010000
8B45 FC
83E8 0A
8945 F0
8b45 F0
50
E8 %ri32
83C4 04
81F8 90909090
0F85 8D000000
8B45 F0
83C0 04
50
E8 %ri32
83C4 04
81F8 90909090
0f85 72000000
8B45 F0
83C0 08
50
E8 %ri32
83C4 04
81F8 9090CD80
0f85 57000000
8B45 F0
50
B8 70314000
50
E8 %THUNK_printf
83C4 08
E8 %regs_data
83C0 20
8945 EC
B8 9060ff15
50
8B45 F0
50
E8 %wi32
83C4 08
8B45 F0
83C0 04
8B4D EC
51
50
E8 %wi32
83C4 08
8B45 F0
83C0 08
B9 83c42090
51
50
E8 %wi32
83C4 08
8B45 FC
83C0 02
8945 FC
8B45 08
83C0 04
8B08
81C1 B8000000
B8 BC174000
8901
8B45 F8
83E8 04
8945 F8
8B45 08
83C0 04
8B08
81C1 C4000000
8B45 F8
8901
8B45 FC
50
8B45 F8
50
E8 %wi32
83C4 08
8B45 08
83C0 04
8B08
81C1 B0000000
8B01
50
B8 00000000
50
E8 %set_reg
83C4 08
8B45 08
83C0 04
8B08
81C1 A4000000
8B01
50
B8 01000000
50
E8 %set_reg
83C4 08
8B45 08
83C0 04
8B08
81C1 AC000000
8B01
50
b8 02000000
50
E8 %set_reg
83C4 08
8B45 08
83C0 04
8B08
81C1 A8000000
8B01
50
B8 03000000
50
E8 %set_reg
83C4 08
8B45 08
83C0 04
8B08
81C1 A0000000
8B01
50
B8 04000000
50
E8 %set_reg
83C4 08
8B45 08
83C0 04
8B08
81C1 9C000000
8B01
50
B8 05000000
50
E8 %set_reg
83C4 08
8B45 08
83C0 04
8b08
81C1 B4000000
8B01
50
B8 06000000
50
E8 %set_reg
83C4 08
B8 FFFFFFFF
E9 1D000000
E9 18000000
B8 8E314000
50
E8 %THUNK_printf
83C4 04
B8 00000000
E9 00000000
C9
C2 0400
:syscall
55
89E5
81EC 00000000
90
8B45 08
81F8 FEFF0000
0F85 47000000
8B05 6C314000
83F8 00
0F84 0A000000
E9 6C000000
E9 29000000
B8 9C314000
50
E8 %THUNK_printf
83C4 04
B8 D41C4000
50
E8 %THUNK_SetUnhandledExceptionFilter
B8 01000000
8905 6C314000
E9 3E000000
E9 2B000000
8B45 08
81F8 FDFF0000
0F85 0A000000
E9 25000000
E9 12000000
8B45 08
50
B8 AD314000
50
E8 %THUNK_printf
83C4 08
B8 01000000
50
E8 %THUNK_exit
83C4 04
C9
C3
:mmap
55
89E5
81EC 04000000
90
8B45 0C
50
8B45 08
50
B8 CE314000
50
E8 %THUNK_printf
83C4 0C
B8 40000000
50
B8 00300000
50
8B45 0C
50
8B45 08
50
E8 %THUNK_VirtualAlloc
8945 FC
8B45 FC
50
B8 F3314000
50
E8 %THUNK_printf
83C4 08
8B45 FC
C9
C3
:get_stdout
55
89E5
81EC 00000000
90
8B05 58324000
83C0 20
C9
C3
:main
55
89E5
81EC 00000000
90
8B45 0C
50
8B45 08
50
E8 %v_main
83C4 08
C9
C3
# I think this might be the entrypoint
# Seems to be either from ./lib/i386-win32-crt1w.o or ./lib/i386-win32-crt1.o
:_start
55
89E5
81EC 24000000
90
8D45 E8
50
E8 %__try__
83C4 04
B8 00000000
8945 E4
B8 01000000
50
E8 %THUNK_9
83C4 04
B8 00000300
50
B8 00000100
50
E8 %THUNK_10
83C4 08
8B05 64324000
8B0D 68324000
8B15 6C324000
8945 E0
8D45 E4
50
8B 05E0334000
50
52
51
8B45 E0
50
E8 %THUNK_11
83C4 14
8B05 64324000
8B0D 68
324000
8B15 6c324000
8945 DC
8B02
50
8B01
50
8B45 DC
8B00
50
e8 %main
83c4 0C
50
E8 %THUNK_exit
83C4 04
C9
C3
# seems to be _runmain from lib/i386-win32-crt1.o
:_runmain
55
89E5
81EC 04000000
90
8B05 64324000
8B4D 08
8908
8B05 68324000
8b4D 0C
8908
B8 00000300
50
b8 00000100
50
E8 %THUNK_10
83C4 08
8B05 64324000
8B0D 68324000
8B15 6c324000
8945 FC
8B02
50
8B01
50
8B45 FC
8B00
50
E8 %main
83C4 0C
C9
C3
# end of _runmain
# 00001350: padding?
00 0000
# see win32/lib/chkstk.S in the tcc source code
:__chkstk
872C24
55
8D6C24 04
51
89E9
:P0
81E9 00100000
8501
2D 00100000
3D 00100000
7D EC
29C1
8501
89E0
89CC
8B08
FF60 04
:_exception_info
8B45 EC
C3
:_exception_code
E8 %_exception_info
8B00
8B00
C3
:seh_filter
E8 %_exception_info
50
E8 %_exception_code
50
E8 %THUNK_12
83C4 08
C3
:seh_except
8B65 E8
E8 %_exception_code
50
E8 %THUNK_13
# padding ?
00 0000
:seh_scopetable
ffff ffff 8e21 4000 a321 4000
e9ab 0000 00
:__try__
55
8B6C24 08
8D4424 0C
8945 00
31C0
8945 04
64A1 00000000
8945 08
B8 C0214000
8945 0C
B8 B4214000
8945 10
31C0
8945 14
8D45 08
64A3 00000000
5D
C3

00

# I suspect the following are "thunks" since FF25 is an indirect jump ie it
# reads the memory location given by the immediate, fetches the value held in
# that location and then jumps there.
# 00001400:
:THUNK_0
:THUNK_printf
ff25 3c32 4000 0000
:THUNK_1
:THUNK_exit
ff25 4032 4000 0000
# 00001410:
:THUNK_2
:THUNK_fopen
ff25 4432 4000 0000
:THUNK_3
:THUNK_fread
ff25 4832 4000 0000
# 00001420:
:THUNK_4
:THUNK_fclose
ff25 4c32 4000 0000
:THUNK_5
:THUNK_puts
ff25 5032 4000 0000
# 00001430:
:THUNK_6
:THUNK_fwrite
ff25 5432 4000 0000
:THUNK_7
:THUNK_SetUnhandledExceptionFilter
ff25 8432 4000 0000
# 00001440:
:THUNK_8
:THUNK_VirtualAlloc
ff25 8832 4000 0000
:THUNK_9
ff25 5c32 4000 0000
# 00001450:
:THUNK_10
ff25 6032 4000 0000
:THUNK_11
ff25 7032 4000 0000
# 00001460:
:THUNK_12
ff25 7432 4000 0000
:THUNK_13
ff25 7832 4000 0000
# 00001470:
:THUNK_14
ff25 7c32 4000 0000

# padding? Seems to be zero all the way to the next section
0000 0000 0000 0000
# 00001480:
0000 0000 0000 0000 0000 0000 0000 0000
# 00001490:
0000 0000 0000 0000 0000 0000 0000 0000
# 000014a0:
0000 0000 0000 0000 0000 0000 0000 0000
# 000014b0:
0000 0000 0000 0000 0000 0000 0000 0000
# 000014c0:
0000 0000 0000 0000 0000 0000 0000 0000
# 000014d0:
0000 0000 0000 0000 0000 0000 0000 0000
# 000014e0:
0000 0000 0000 0000 0000 0000 0000 0000
# 000014f0:
0000 0000 0000 0000 0000 0000 0000 0000
